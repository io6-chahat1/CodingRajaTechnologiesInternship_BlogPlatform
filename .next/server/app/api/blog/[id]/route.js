"use strict";(()=>{var e={};e.id=749,e.ids=[749],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},16735:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>S,originalPathname:()=>B,patchFetch:()=>j,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>y,staticGenerationBailout:()=>w});var o={};r.r(o),r.d(o,{DELETE:()=>g,GET:()=>p,PUT:()=>c});var n=r(95419),s=r(69108),a=r(99678),i=r(62878),u=r(78070),d=r(68571),l=r(48011);async function c(e,t){await (0,i.$)();let r=t.params.id,o=e.headers.get("authorization"),n=o.split(" ")[1],s=(0,d.s)(n);if(!o||!s)return u.Z.json({error:"unauthorized (wrong or expired token)"},{status:403});try{let t=await e.json(),o=await l.Z.findById(r).populate("authorId");if(o?.authorId?._id.toString()!==s._id.toString())return u.Z.json({msg:"Only author can update his/her blog"},{status:403});let n=await l.Z.findByIdAndUpdate(r,{$set:{...t}},{new:!0});return u.Z.json(n,{status:200})}catch(e){return u.Z.json({message:"PUT error"},{status:500})}}async function p(e,t){await (0,i.$)();let r=t.params.id;try{let e=await l.Z.findById(r).populate({path:"authorId",select:"-password"}).populate({path:"comments.user",select:"-password"});return u.Z.json(e,{status:200})}catch(e){return u.Z.json({message:"GET error"},{status:500})}}async function g(e,t){await (0,i.$)();let r=t.params.id,o=e.headers.get("authorization"),n=o.split(" ")[1],s=(0,d.s)(n);if(!o||!s)return u.Z.json({error:"unauthorized (wrong or expired token)"},{status:403});try{let e=await l.Z.findById(r).populate("authorId");if(e?.authorId?._id.toString()!==s._id.toString())return u.Z.json({msg:"Only author can delete his/her blog"},{status:403});return await l.Z.findByIdAndDelete(r),u.Z.json({msg:"Successfully deleted blog"},{status:200})}catch(e){return u.Z.json({message:"Delete error"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/blog/[id]/route",pathname:"/api/blog/[id]",filename:"route",bundlePath:"app/api/blog/[id]/route"},resolvedPagePath:"C:\\Users\\prena\\OneDrive\\Desktop\\CodingRajaTechnologiesInternship_BloggingPlatform\\app\\api\\blog\\[id]\\route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:y,serverHooks:f,headerHooks:S,staticGenerationBailout:w}=h,B="/api/blog/[id]/route";function j(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:y})}},62878:(e,t,r)=>{r.d(t,{$:()=>s});var o=r(11185),n=r.n(o);async function s(){try{n().connect(process.env.MONGODB_URL);let e=n().connection;e.on("connected",()=>{console.log("MongoDB connected successfully")}),e.on("error",e=>{console.log("MongoDB connection error. Please make sure MongoDB is running. "+e),process.exit()})}catch(e){console.log("Something goes wrong!"),console.log(e)}}},68571:(e,t,r)=>{r.d(t,{f:()=>s,s:()=>a});var o=r(46082),n=r.n(o);function s(e,t={}){let r=process.env.JWT_SECRET;return n().sign(e,r,t)}function a(e){try{let t=process.env.JWT_SECRET;return n().verify(e,t)}catch(e){return console.log(e),null}}},48011:(e,t,r)=>{r.d(t,{Z:()=>a});var o=r(11185),n=r.n(o);let s=new(n()).Schema({title:{type:String,required:!0,min:4},description:{type:String,required:!0,min:20},excerpt:{type:String,required:!0,min:10},quote:{type:String,required:!0,min:6},image:{id:{type:String},url:{type:String}},category:{type:String,required:!0,enum:["Food Blogs","Travel Blogs","Health & Fitness Blogs","Tech Blogs","Nature Blogs","Finance Blogs"]},authorId:{type:n().Schema.Types.ObjectId,ref:"User"},likes:{type:[n().Schema.Types.ObjectId],ref:"User",default:[]},comments:[{user:{type:n().Schema.Types.ObjectId,ref:"User",required:!0},text:{type:String,required:!0},date:{type:Date,default:Date.now}}]},{timestamps:!0}),a=n()?.models?.Blog||n().model("Blog",s)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,987,206],()=>r(16735));module.exports=o})();