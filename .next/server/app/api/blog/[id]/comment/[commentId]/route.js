"use strict";(()=>{var e={};e.id=786,e.ids=[786],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},72730:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>y,originalPathname:()=>S,patchFetch:()=>v,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>f});var o={};r.r(o),r.d(o,{DELETE:()=>d});var n=r(95419),s=r(69108),i=r(99678),a=r(62878),u=r(78070),c=r(68571),m=r(48011);async function d(e,t){await (0,a.$)();let r=t.params.id,o=t.params.commentId,n=e.headers.get("authorization"),s=n.split(" ")[1],i=(0,c.s)(s);if(!n||!i)return u.Z.json({error:"unauthorized (wrong or expired token)"},{status:403});try{let e=await m.Z.findById(r).populate("authorId").populate("comments.user"),t=e.comments.find(e=>e.id===o);if(!t)return u.Z.json({mes:"Comment does not exist"},{status:404});if(t?.user?._id.toString()!==i._id.toString())return u.Z.json({msg:"Only author can delete his/her comment"},{status:403});return e.comments=e.comments.filter(e=>e.id!==o),await e.save(),u.Z.json({msg:"Successfully deleted comment"},{status:200})}catch(e){return u.Z.json({message:"Delete error"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/blog/[id]/comment/[commentId]/route",pathname:"/api/blog/[id]/comment/[commentId]",filename:"route",bundlePath:"app/api/blog/[id]/comment/[commentId]/route"},resolvedPagePath:"C:\\Users\\prena\\OneDrive\\Desktop\\CodingRajaTechnologiesInternship_BloggingPlatform\\app\\api\\blog\\[id]\\comment\\[commentId]\\route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:h,headerHooks:y,staticGenerationBailout:f}=l,S="/api/blog/[id]/comment/[commentId]/route";function v(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},62878:(e,t,r)=>{r.d(t,{$:()=>s});var o=r(11185),n=r.n(o);async function s(){try{n().connect(process.env.MONGODB_URL);let e=n().connection;e.on("connected",()=>{console.log("MongoDB connected successfully")}),e.on("error",e=>{console.log("MongoDB connection error. Please make sure MongoDB is running. "+e),process.exit()})}catch(e){console.log("Something goes wrong!"),console.log(e)}}},68571:(e,t,r)=>{r.d(t,{f:()=>s,s:()=>i});var o=r(46082),n=r.n(o);function s(e,t={}){let r=process.env.JWT_SECRET;return n().sign(e,r,t)}function i(e){try{let t=process.env.JWT_SECRET;return n().verify(e,t)}catch(e){return console.log(e),null}}},48011:(e,t,r)=>{r.d(t,{Z:()=>i});var o=r(11185),n=r.n(o);let s=new(n()).Schema({title:{type:String,required:!0,min:4},description:{type:String,required:!0,min:20},excerpt:{type:String,required:!0,min:10},quote:{type:String,required:!0,min:6},image:{id:{type:String},url:{type:String}},category:{type:String,required:!0,enum:["Food Blogs","Travel Blogs","Health & Fitness Blogs","Tech Blogs","Nature Blogs","Finance Blogs"]},authorId:{type:n().Schema.Types.ObjectId,ref:"User"},likes:{type:[n().Schema.Types.ObjectId],ref:"User",default:[]},comments:[{user:{type:n().Schema.Types.ObjectId,ref:"User",required:!0},text:{type:String,required:!0},date:{type:Date,default:Date.now}}]},{timestamps:!0}),i=n()?.models?.Blog||n().model("Blog",s)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,987,206],()=>r(72730));module.exports=o})();